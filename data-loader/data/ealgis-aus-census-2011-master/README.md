
EAlGIS - Australian Census 2011
===============================

(To find out what EAlGIS is, see https://github.com/grahame/ealgis/)

Importing the census
--------------------

Run:

    docker-compose run dataloader /bin/bash
    cd /app/data/ealgis-aus-census-2011-master/
    chmod +x load.sh
    ./load.sh

If you have not already downloaded the census, it will be downloaded and 
extracted.

Once that has run successfully, consult the output and run `pg_restore` on ./tmp/aus_census_2011 into your actual EAlGIS database. Don't forget to run `VACUUM ANALYZE;` too.

```
pg_restore --username=postgres --dbname=postgres /app/aus_census_2011
```

Lastly, we then want to add materialised views for census geometries that bake in simplified geometries appropriate for lower zoom levels.

`aus_census_2011_matviews_v01.sql` was generated by hitting `https://localhost:8443/api/0.1/datainfo/create_views.json?all_tables=1` once the previous step has created.

```
psql -d postgres -U postgres -a -f ./aus_census_2011_matviews_v01.sql
```

**Note:** At the time of writing we expect this to be a temporary measure that will be replaced by Mapbox Vector Tiles
created direclty in PostgreSQL/PostGIS. If it's not a temporary measure then we'll bake it into the tables created by the data loader itself.